<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport"
  content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<title>荒教団</title>

<style>
:root{
  --red:#ff003c;
  --blue:#00f2ff;
  --bg:#050205;
}

*{
  box-sizing:border-box;
  touch-action:manipulation;
  -webkit-tap-highlight-color:transparent;
}

html,body{
  margin:0;
  width:100%;
  height:100%;
  background:#000;
  overflow:hidden;
  font-family:'Hiragino Mincho ProN',serif;
}

/* ===== TV 枠（触れない） ===== */
.tv{
  position:relative;
  width:100%;
  height:100%;
  padding:18px;
  background:#111;
}

.tv-frame{
  position:absolute;
  inset:0;
  border-radius:36px;
  border:14px solid #222;
  box-shadow:inset 0 0 60px #000;
  pointer-events:none;
}

/* ===== 実画面 ===== */
.screen{
  position:relative;
  width:100%;
  height:100%;
  border-radius:28px;
  background:#000;
  overflow:hidden;
}

/* 実際に触るレイヤー */
.screen-inner{
  position:absolute;
  inset:0;
  background:var(--bg);
  color:#ddd;
  overflow:hidden;
}

/* ===== 走査線 ===== */
.screen-inner::after{
  content:"";
  position:absolute;
  inset:0;
  background:linear-gradient(
    rgba(18,16,16,0) 50%,
    rgba(0,0,0,.25) 50%
  );
  background-size:100% 4px;
  z-index:30;
  pointer-events:none;
}

/* ===== 電源ON ===== */
.boot{
  position:absolute;
  inset:0;
  background:#000;
  z-index:50;
  display:flex;
  justify-content:center;
  align-items:center;
}
.boot-line{
  width:0;
  height:2px;
  background:#fff;
  animation:boot 1.2s forwards;
}
@keyframes boot{
  30%{width:100%}
  60%{filter:blur(2px)}
  100%{width:100%;height:100%}
}

/* ===== 教典 ===== */
.header{
  text-align:center;
  padding:28px 10px;
}
.glitch{
  font-size:2.4rem;
  text-shadow:-2px 0 var(--blue),2px 0 var(--red);
}
.scripture{
  padding:20px;
  font-size:.8rem;
  line-height:2;
}
.scripture p{
  border-left:2px solid var(--blue);
  padding-left:10px;
  margin:22px 0;
  color:#aaa;
}

/* ===== 入信 ===== */
.join{
  margin:30px auto;
  width:200px;
  padding:14px;
  text-align:center;
  border:2px solid var(--red);
  color:var(--red);
  user-select:none;
}
.join.hold{
  background:rgba(255,0,60,.4);
  color:#fff;
}

/* ===== 波紋 ===== */
.ripple{
  position:absolute;
  width:20px;
  height:20px;
  border-radius:50%;
  background:radial-gradient(
    circle,
    rgba(0,242,255,.4),
    rgba(0,242,255,.15),
    rgba(0,0,0,0) 70%
  );
  transform:scale(0);
  animation:ripple 1s ease-out forwards;
  pointer-events:none;
  z-index:10;
}
@keyframes ripple{
  to{transform:scale(18);opacity:0}
}

/* ===== 割れ ===== */
.shatter{
  position:absolute;
  inset:0;
  z-index:40;
  pointer-events:none;
}
.shard{
  position:absolute;
  inset:0;
  background:var(--bg);
  animation:shard .8s ease-out forwards;
}
@keyframes shard{
  to{
    transform:translate(var(--dx),var(--dy)) scale(1.1);
    opacity:0;
  }
}

/* ===== 通知ログ ===== */
.notify-box{
  position:fixed;
  right:12px;
  bottom:12px;
  width:230px;
  display:flex;
  flex-direction:column;
  gap:6px;
  z-index:100;
}
.notify{
  background:#111;
  border-left:3px solid var(--red);
  padding:8px;
  font-size:.65rem;
  color:#ccc;
}
</style>
</head>

<body>

<div class="tv">
  <div class="tv-frame"></div>

  <div class="screen">
    <div class="screen-inner" id="screen">

      <div class="boot" id="boot">
        <div class="boot-line"></div>
      </div>

      <div class="header">
        <div class="glitch">荒教団</div>
        <div style="font-size:.65rem;color:#666">SERIAL: ARASH-000</div>
      </div>

      <div class="scripture">
        <p>―― 接続は既に完了している</p>
        <p>―― 拒否は記録されない</p>
        <p>―― 観測は継続中</p>
        <p>―― 入信とは破壊である</p>
      </div>

      <div class="join" id="join">長押しで入信</div>
    </div>
  </div>
</div>

<div class="notify-box" id="notifyBox"></div>

<script>
document.addEventListener('gesturestart', e => e.preventDefault());

/* boot */
setTimeout(()=>boot.remove(),1200);

const screen=document.getElementById('screen');
const box=document.getElementById('notifyBox');
let interference=0;

/* 波紋 */
screen.addEventListener('pointerdown',e=>{
  const r=screen.getBoundingClientRect();
  const x=e.clientX-r.left;
  const y=e.clientY-r.top;

  const rip=document.createElement('div');
  rip.className='ripple';
  rip.style.left=`${x-10}px`;
  rip.style.top =`${y-10}px`;
  screen.appendChild(rip);
  rip.onanimationend=()=>rip.remove();

  interference++;
});

/* 通知蓄積 */
function notify(t){
  const n=document.createElement('div');
  n.className='notify';
  n.textContent=t;
  box.prepend(n);
  if(box.children.length>8){
    box.lastChild.remove();
  }
}

setInterval(()=>{
  notify(
    interference>20
    ? "過剰干渉を検出"
    : "外部観測ログ受信"
  );
},2600);

/* 入信 */
const btn=document.getElementById('join');
let timer,cancel=false;

btn.addEventListener('pointerdown',e=>{
  e.preventDefault();
  cancel=false;
  btn.classList.add('hold');
  btn.textContent="接続中…";
  timer=setTimeout(shatter,2800);
});
btn.addEventListener('pointerup',reset);
btn.addEventListener('pointerleave',reset);
btn.addEventListener('touchstart',e=>{
  if(e.touches.length>1) cancel=true;
});

function reset(){
  clearTimeout(timer);
  btn.classList.remove('hold');
  btn.textContent="長押しで入信";
}

function shatter(){
  const s=document.createElement('div');
  s.className='shatter';
  const count=Math.min(12,4+Math.floor(interference/4));

  for(let i=0;i<count;i++){
    const p=document.createElement('div');
    p.className='shard';
    p.style.clipPath=`polygon(50% 50%, ${Math.random()*100}% 0, 100% ${Math.random()*100}%)`;
    const a=Math.random()*360;
    p.style.setProperty('--dx',`${Math.cos(a)*200}px`);
    p.style.setProperty('--dy',`${Math.sin(a)*200}px`);
    s.appendChild(p);
  }
  screen.appendChild(s);

  if(cancel){
    notify("拒絶反応を確認");
    return;
  }

  setTimeout(()=>{
    notify("接続確定");
  },600);
}
</script>

</body>
</html>
